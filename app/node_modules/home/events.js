var dal = require('dal/project');
//
// test the first load of json data to determine if we want this
// module's handler to be executed.
//
exports.test = function(stream, data) {
  if (data.page && data.page == 'home') return true;
};

//
// gives you the stream and the first load of json data.
// you can continue to listen, once or multiple times (on, pipe).
//
exports.handler = function(stream, data) {

  if (data.add) {
    dal.addProject(data.add, function(err) {
      stream.write({
        page: 'home',
        add: data,
        error: err && err.message
      });
    });
  }
  else if (data.remove) {
    dal.removeProject(data.remove, function(err) {
      stream.write({
        page: 'home',
        remove: data.remove,
        error: err && err.message
      });
    })
  }
};

